<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>3D Demo</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: radial-gradient(circle at top, #222, #000);
    }

    #ui {
        position: fixed;
        bottom: 20px;
        width: 100%;
        text-align: center;
        z-index: 10;
    }

    button {
        font-size: 22px;
        margin: 6px;
        padding: 10px 18px;
        border-radius: 12px;
        border: none;
        background: #333;
        color: white;
    }

    button:active {
        background: #555;
    }
</style>
</head>
<body>

<div id="ui">
    <button onclick="rotateLeft()">←</button>
    <button onclick="rotateRight()">→</button>
    <button onclick="rotateUp()">↑</button>
    <button onclick="rotateDown()">↓</button>
    <button onclick="changeColor()">Color</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(
        60,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
    );
    camera.position.z = 3;

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0x000000);
    document.body.appendChild(renderer.domElement);

    // Куб
    const geometry = new THREE.BoxGeometry(1, 1, 1);
    let material = new THREE.MeshStandardMaterial({
        color: 0x00ff99,
        metalness: 0.3,
        roughness: 0.3
    });

    const cube = new THREE.Mesh(geometry, material);
    scene.add(cube);

    // Свет
    const ambient = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(ambient);

    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(5, 5, 5);
    scene.add(light);

    // -------- ЭФФЕКТЫ --------

    let autoRotate = true;
    let pulseTime = 0;

    // Управление мышью / пальцем
    let isDragging = false;
    let lastX = 0;
    let lastY = 0;

    renderer.domElement.addEventListener("mousedown", startDrag);
    renderer.domElement.addEventListener("touchstart", startDrag);

    renderer.domElement.addEventListener("mousemove", drag);
    renderer.domElement.addEventListener("touchmove", drag);

    renderer.domElement.addEventListener("mouseup", endDrag);
    renderer.domElement.addEventListener("touchend", endDrag);

    function startDrag(e) {
        isDragging = true;
        autoRotate = false;

        const p = e.touches ? e.touches[0] : e;
        lastX = p.clientX;
        lastY = p.clientY;
    }

    function drag(e) {
        if (!isDragging) return;

        const p = e.touches ? e.touches[0] : e;
        let dx = (p.clientX - lastX) * 0.01;
        let dy = (p.clientY - lastY) * 0.01;

        cube.rotation.y += dx;
        cube.rotation.x += dy;

        lastX = p.clientX;
        lastY = p.clientY;
    }

    function endDrag() {
        isDragging = false;
        autoRotate = true;
    }

    // Кнопки
    function rotateLeft()  { cube.rotation.y -= 0.3; }
    function rotateRight() { cube.rotation.y += 0.3; }
    function rotateUp()    { cube.rotation.x -= 0.3; }
    function rotateDown()  { cube.rotation.x += 0.3; }

    function changeColor() {
        material.color.setRGB(Math.random(), Math.random(), Math.random());
    }

    // Анимация
    function animate() {
        requestAnimationFrame(animate);

        // Автовращение
        if (autoRotate) {
            cube.rotation.y += 0.01;
            cube.rotation.x += 0.005;
        }

        // Пульсация (дыхание)
        pulseTime += 0.03;
        let scale = 1 + Math.sin(pulseTime) * 0.05;
        cube.scale.set(scale, scale, scale);

        renderer.render(scene, camera);
    }

    animate();

    // Адаптация под размер экрана
    window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>

</body>
</html>
